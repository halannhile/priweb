<!DOCTYPE html>
<html>
  <head>
    <title>A feature-based unsupervised approach for outlier detection in water quality data from in situ sensors</title>
    <meta charset="utf-8">
    <link href="libs/remark-css/default.css" rel="stylesheet" />
    <link rel="stylesheet" href="myremark.css" type="text/css" />
  </head>
  <body>
    <textarea id="source">
class: center, middle, inverse, title-slide

# A feature-based unsupervised approach for outlier detection in water quality data from in situ sensors
## <br/> Priyanga Dilini Talagala <br/> with<br/> Rob J. Hyndman <br/> Catherine Leigh <br/> Kerrie Mengersen <br/> Kate Smith-Miles
### Monash University, Australia <br/> <br/>09.10.2018

---






### Anomaly Detection 


&lt;img src="fig/Visualise_anomaly.png" width="90%" /&gt;

&lt;span style="color:blue"&gt;**Anomaly Definition:**&lt;/span&gt; Unusual behaviours due to technical issues with the sensor equipment.
&lt;br/&gt;&lt;br/&gt;  Outlier Detection,  Variability Detection, Drift Detection, Rule based approaches

---
### Outlier Detection


&lt;img src="fig/Visualise_outlier.png" width="90%" /&gt;

&lt;span style="color:blue"&gt;**Outlier Definition:**&lt;/span&gt; A point which is significantly different (with respect to distance or density) from the majority of a given data space 
&lt;br/&gt; &lt;br/&gt;  &lt;span style="color:red"&gt;Outlier Detection &lt;/span&gt;, Variability Detection, Drift Detection, &lt;span style="color:red"&gt;Rule based approaches &lt;/span&gt;

---


&lt;img src="fig/Visualise_outlier.png" width="75%" style="display: block; margin: auto;" /&gt;

&lt;span style="color:blue"&gt;**Our focus:**&lt;/span&gt;
&lt;br/&gt; Large sudden spikes(A), Sudden Shifts (D), Clusters of Spikes (I), Small Sudden spikes (J)
&lt;br/&gt; &lt;br/&gt;  Out-of-sensor-range values (G), Missing values (K), Impossible values (F) - &lt;span style="color:gray"&gt;Rule based Approaches &lt;/span&gt;

&lt;span style="color:blue"&gt;**Further Work:** &lt;/span&gt;
&lt;br/&gt;  Low variability(B), High Variability (E), Constant offset (C), Drift (H)
---



&lt;div class="figure" style="text-align: center"&gt;
&lt;img src="fig/Visualise_outlier_pairs_original_data.png" alt="Bivariate relationships between original variables" width="100%" /&gt;
&lt;p class="caption"&gt;Bivariate relationships between original variables&lt;/p&gt;
&lt;/div&gt;
---




&lt;div class="figure" style="text-align: center"&gt;
&lt;img src="fig/transform_type.png" alt="(a) Original series, (b) Log transformation, (c) First difference, (d) First derivative, (e) Rate of change. (f) One sided derivative" width="100%" /&gt;
&lt;p class="caption"&gt;(a) Original series, (b) Log transformation, (c) First difference, (d) First derivative, (e) Rate of change. (f) One sided derivative&lt;/p&gt;
&lt;/div&gt;



---




&lt;img src="fig/timegapSandy.png" width="80%" height="20%" style="display: block; margin: auto;" /&gt;

--

&lt;div class="figure" style="text-align: center"&gt;
&lt;img src="fig/trans_demo_TCL.png" alt="Transformed series (one sided derivatives)" width="80%" /&gt;
&lt;p class="caption"&gt;Transformed series (one sided derivatives)&lt;/p&gt;
&lt;/div&gt;

---

&lt;div class="figure" style="text-align: center"&gt;
&lt;img src="fig/Visualise_outlier_pairs_original_data.png" alt="Bivariate Relationships between original variables" width="100%" /&gt;
&lt;p class="caption"&gt;Bivariate Relationships between original variables&lt;/p&gt;
&lt;/div&gt;

---


&lt;div class="figure" style="text-align: center"&gt;
&lt;img src="fig/Visualise_outlier_pairs_trans_data.png" alt="Bivariate relationships between transfomred series (one sided derivative)" width="100%" /&gt;
&lt;p class="caption"&gt;Bivariate relationships between transfomred series (one sided derivative)&lt;/p&gt;
&lt;/div&gt;

---

### Distance and density based anomaly detection methods



&lt;img src="fig/outlier_Score_demo.png" width="70%" style="display: block; margin: auto;" /&gt;

---

### Distance and density based anomaly detection methods

&lt;img src="fig/outlier_Score.png" width="70%" style="display: block; margin: auto;" /&gt;

---
### Distance and density based anomaly detection methods

&lt;img src="fig/outlier_Score_demo_anom1.png" width="70%" style="display: block; margin: auto;" /&gt;

---

### Distance and density based anomaly detection methods

&lt;img src="fig/outlier_Score_demo_anom2.png" width="70%" style="display: block; margin: auto;" /&gt;

---
## Outlier Threshold Calculation


**Theorem**  (Weissman's Spacing Theorem). (Weissman (1978), Theorem 3) (Burridge and Taylor (2006),Proposition 1)

*Let* `\(D_{i,n} = X_{i:n}-X_{i+1:n}\)` *be the spacings between successive order statistics. Then, provided* `\(F\)` *is in the maximum domain of attraction of the Gumbel distribution, and for a suitable sequence of constants*, `\(a_n\)`, *the objects,* `\(\left\{a_{n}^{-1}D_{i,n}, i=1, \dots,K \right\}\)`, *converge in distribution under the null hypothesis of no outliers to a vector of* `\(K\)` *independent exponential variates with means proportional to* `\(i^{-1}\)`.


&lt;img src="fig/spacing_theorem.png" width="70%" style="display: block; margin: auto;" /&gt;

---

### Distance and density based anomaly detection methods


&lt;img src="fig/one_sided_derivative_TCL_sandy.png" width="70%" style="display: block; margin: auto;" /&gt;

---

## Main Contributions

- Propose an **unsupervised** framework that provides early detection of technical outliers in water-quality data from *in-situ* sensors.
- Introduce an R package, `oddwater`, that implements the proposed framework and related functions.


```r
# install.packages("devtools")
devtools::install_github("pridiltal/oddwater")
```
- `oddwater` package also provides a shiny app to explore data. 



```r
## Launch Shiny application
oddwater::explore_data()
```

---

## Advantages of the proposed framework

1. (1) Takes the correlation structure of the water-quality variables into account when detecting anomalies. 

2. (2) Can be applied to both univariate and multivariate problems.

3. (3) Unsupervised, data-driven approaches and therefore do not require training data sets for the model building process, and can be extended easily to other time series from other sites. 

4. (4) The anomalous thresholds have a probabilistic interpretation. 
5. (5) The framework can easily be extended to streaming data such that it can provide near-real-time support. 

6. (6) The proposed framework also has the ability to deal with irregular time series.

## Further Work

- To explore the ability of other transformations to capture other anomaly types such as **high and low variability** and **drift**.

---
## Key References

- *Talagala, P. D., Hyndman, R., Leigh, C., Mengersen, K., Smith-Miles, K. (For review). A feature-based unsupervised approach for outlier detection in water quality data from in situ sensors. Water Resources Research.*
    </textarea>
<script src="https://remarkjs.com/downloads/remark-latest.min.js"></script>
<script>var slideshow = remark.create({
"highlightStyle": "github",
"highlightLines": true,
"countIncrementalSlides": false,
"slideNumberFormat": "%current%"
});
if (window.HTMLWidgets) slideshow.on('afterShowSlide', function (slide) {
  window.dispatchEvent(new Event('resize'));
});
(function() {
  var d = document, s = d.createElement("style"), r = d.querySelector(".remark-slide-scaler");
  if (!r) return;
  s.type = "text/css"; s.innerHTML = "@page {size: " + r.style.width + " " + r.style.height +"; }";
  d.head.appendChild(s);
})();</script>

<script>
(function() {
  var i, text, code, codes = document.getElementsByTagName('code');
  for (i = 0; i < codes.length;) {
    code = codes[i];
    if (code.parentNode.tagName !== 'PRE' && code.childElementCount === 0) {
      text = code.textContent;
      if (/^\\\((.|\s)+\\\)$/.test(text) || /^\\\[(.|\s)+\\\]$/.test(text) ||
          /^\$\$(.|\s)+\$\$$/.test(text) ||
          /^\\begin\{([^}]+)\}(.|\s)+\\end\{[^}]+\}$/.test(text)) {
        code.outerHTML = code.innerHTML;  // remove <code></code>
        continue;
      }
    }
    i++;
  }
})();
</script>
<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
(function () {
  var script = document.createElement('script');
  script.type = 'text/javascript';
  script.src  = 'https://cdn.bootcss.com/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML';
  if (location.protocol !== 'file:' && /^https?:/.test(script.src))
    script.src  = script.src.replace(/^https?:/, '');
  document.getElementsByTagName('head')[0].appendChild(script);
})();
</script>
  </body>
</html>
